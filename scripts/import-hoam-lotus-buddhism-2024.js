const { createClient } = require('@supabase/supabase-js');
const path = require('path');
const { v4: uuidv4 } = require('uuid');
require('dotenv').config({ path: path.join(__dirname, '../backend/.env') });

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_SERVICE_KEY
);

async function importHoamLotusBuddhism2024() {
  console.log('ğŸ¨ í˜¸ì•”ë¯¸ìˆ ê´€ ã€Šì§„í™ì— ë¬¼ë“¤ì§€ ì•ŠëŠ” ì—°ê½ƒì²˜ëŸ¼ã€‹ ì „ì‹œ ë°ì´í„° ì…ë ¥ ì‹œì‘...\n');
  
  try {
    const exhibitionData = {
      id: uuidv4(),
      
      // ê¸°ë³¸ ì •ë³´
      title_local: 'ì§„í™ì— ë¬¼ë“¤ì§€ ì•ŠëŠ” ì—°ê½ƒì²˜ëŸ¼',
      title_en: 'Like a Lotus Untainted by Mud',
      subtitle: 'ì  ë” ê´€ì ì—ì„œ ì¡°ë§í•œ ë™ì•„ì‹œì•„ ë¶ˆêµë¯¸ìˆ  ìµœì´ˆ ëŒ€ê·œëª¨ ê¸°íšì „',
      
      // ë‚ ì§œ
      start_date: '2024-03-27',
      end_date: '2024-06-16',
      exhibition_type: 'special',
      status: 'closed', // ì´ë¯¸ ì¢…ë£Œëœ ì „ì‹œ
      
      // ì¥ì†Œ ì •ë³´
      venue_name: 'í˜¸ì•”ë¯¸ìˆ ê´€',
      venue_city: 'ìš©ì¸',
      venue_country: 'KR',
      venue_address: 'ê²½ê¸°ë„ ìš©ì¸ì‹œ ì²˜ì¸êµ¬ í¬ê³¡ì ì—ë²„ëœë“œë¡œ 562ë²ˆê¸¸ 38',
      
      // ì „ì‹œ ì„¤ëª…
      description: `í˜¸ì•”ë¯¸ìˆ ê´€ì€ ì  ë”ë¼ëŠ” ê´€ì ì—ì„œ ë™ì•„ì‹œì•„ ë¶ˆêµë¯¸ìˆ ì„ ì¡°ë§í•˜ëŠ” ìµœì´ˆì˜ ëŒ€ê·œëª¨ ê¸°íšì „ ã€Šì§„í™ì— ë¬¼ë“¤ì§€ ì•ŠëŠ” ì—°ê½ƒì²˜ëŸ¼ã€‹ì„ ê°œìµœí•©ë‹ˆë‹¤. ë¶ˆêµ ì†ì—ì„œ ì—¬ì„±ì€ ì–´ë–¤ ì¡´ì¬ì˜€ìœ¼ë©° ì—¬ì„±ì€ ë¶ˆêµì—ì„œ ë¬´ì—‡ì„ ì°¾ì•˜ë˜ ê²ƒì¼ê¹Œìš”. ì´ë²ˆ ì „ì‹œëŠ” 92ê±´ì˜ ë™ì•„ì‹œì•„ ë¶ˆêµë¯¸ìˆ í’ˆì„ í†µí•´ 'ë¶ˆêµë¯¸ìˆ  ì† ì—¬ì„±'ê³¼ 'ì œì‘ê³¼ í›„ì›ì˜ ì£¼ì²´ë¡œì„œ ì—¬ì„±'ì´ë¼ëŠ” ë‘ ì£¼ì œë¥¼ ì¡°ëª…í•©ë‹ˆë‹¤.

[ì „ì‹œ ì˜ì˜]
â€¢ ì  ë” ê´€ì ì—ì„œ ë™ì•„ì‹œì•„ ë¶ˆêµë¯¸ìˆ ì„ ì¡°ë§í•˜ëŠ” ìµœì´ˆì˜ ëŒ€ê·œëª¨ ê¸°íšì „
â€¢ ë¶ˆêµë¯¸ìˆ ì— ë‹´ê¸´ ì—¬ì„±ì˜ ì—¼ì›ê³¼ ê³ ë‡Œ, ê³µí—Œì— ì£¼ëª©
â€¢ ì „í†µ ì†ì—ì„œ ë™ì‹œëŒ€ì  ì˜ë¯¸ë¥¼ ì½ì„ ìˆ˜ ìˆëŠ” ê¸°íšŒ
â€¢ ì‚¬íšŒì , ì œë„ì  ì°¨ë³„ì— ì–½ë§¤ì´ì§€ ì•Šê³  ê¹¨ë‹¬ìŒì„ í–¥í•œ ì‹¤ì²œì„ ì´ì–´ê°„ ì—¬ì„±ë“¤ ì¡°ëª…

[ì°¸ì—¬ ê¸°ê´€ - êµ­ë‚´ì™¸ 27ê°œ ê¸°ê´€]
â€¢ êµ­ë‚´: ë¦¬ì›€ë¯¸ìˆ ê´€ ì™¸ 9ê°œ ê¸°ê´€
â€¢ í•´ì™¸: ìœ ëŸ½ 3ê°œ ê¸°ê´€, ë¯¸êµ­ 4ê°œ ê¸°ê´€, ì¼ë³¸ 11ê°œ ê¸°ê´€
â€¢ ì£¼ìš” ì†Œì¥ì²˜: ë©”íŠ¸ë¡œí´ë¦¬íƒ„ë¯¸ìˆ ê´€, ë³´ìŠ¤í„´ë¯¸ìˆ ê´€, ì˜êµ­ë°•ë¬¼ê´€, ë„ì¿„êµ­ë¦½ë°•ë¬¼ê´€, í´ë¦¬ë¸”ëœë“œë¯¸ìˆ ê´€ ë“±

[ì „ì‹œ êµ¬ì„±]

**1ë¶€: ë‹¤ì‹œ ë‚˜íƒ€ë‚˜ëŠ” ì—¬ì„±**
ë¶ˆêµë¯¸ìˆ  ì†ì— ì¬í˜„ëœ ì—¬ì„±ìƒì„ ì¸ê°„, ë³´ì‚´, ì—¬ì‹ ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì‚´í´ë´„ìœ¼ë¡œì¨ ì§€ë‚œ ì‹œëŒ€ì™€ ì‚¬íšŒê°€ ì—¬ì„±ì„ ë°”ë¼ë³¸ ì‹œì„ ì„ ì¡°ëª…

â€¢ "ì—¬ì„±ì˜ ëª¸: ëª¨ì„±æ¯æ€§ê³¼ ë¶€ì •ä¸æ·¨" - ì¸ê°„ ì—¬ì„±ìƒ
â€¢ "ê´€ìŒ: ë³€ì‹ è®Šèº«ê³¼ ë³€ì„±è®Šæ€§" - ì—¬ì„±í˜•ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” íŠ¹ë³„í•œ ë³´ì‚´
â€¢ "ì—¬ì‹ ë“¤ì˜ ì„¸ê³„: ì¶”ì•™ê³¼ ê¸¸ë“¤ì„ ì‚¬ì´" - ì—¬ì„± ì‹ ê²©

**2ë¶€: ì—¬ì„±ì˜ í–‰ì›è¡Œé¡˜**
ì°¬ë€í•œ ë¶ˆêµë¯¸ìˆ í’ˆ ë„ˆë¨¸ í›„ì›ìì™€ ì œì‘ìë¡œì„œ ì—¬ì„±ì„ ë°œêµ´, ì‚¬íšŒì™€ ì œë„ì˜ ì œì•½ì—ì„œ ë²—ì–´ë‚˜ ìê¸°ë¡œì„œ ì‚´ê³ ì í–ˆë˜ ì—¬ì„±ë“¤ì„ ì¡°ëª…

â€¢ "ê°„ì ˆíˆ ë°”ë¼ì˜µê±´ëŒ€: ì„±ë¶ˆæˆä½›ê³¼ ì™•ìƒå¾€ç”Ÿ" - ë¶ˆêµë„ì˜ ê¶ê·¹ì  ë°”ëŒê³¼ ì—¼ì›
â€¢ "'ì•”íƒ‰ì´ ìš¸ ë•Œ': ìœ êµì‚¬íšŒì˜ ë¶ˆêµì—¬ì„±" - ì¡°ì„  ì™•ì‹¤ ì—¬ì„±ë“¤ì˜ ë¶ˆêµ ì§€ì§€
â€¢ "ì—¬ê³µå¥³å·¥: ë°”ëŠ˜ê³¼ ì‹¤ì˜ ê³µë•" - ì—¬ì„±ë“¤ì˜ ì‹ ì•™ê³¼ ì°½ì¡°ì  ì—­ëŸ‰ì´ êµì°¨í•œ ë¶ˆêµ ììˆ˜ì™€ ë³µì‹

[ì£¼ìš” ì‘í’ˆ]

**ê³ ë ¤ë¶ˆí™” ê±¸ì‘ë“¤**
â€¢ ã€Šìˆ˜ì›”ê´€ìŒë³´ì‚´ë„ã€‹ (ê³ ë ¤ 14ì„¸ê¸°, ê°œì¸ ì†Œì¥, ë³´ë¬¼) - 5.7~6.16 ì „ì‹œ
â€¢ ã€Šì•„ë¯¸íƒ€ì—¬ë˜ì‚¼ì¡´ë„ã€‹ (ê³ ë ¤ 14ì„¸ê¸°, ë¦¬ì›€ë¯¸ìˆ ê´€)
â€¢ ã€Šì²œìˆ˜ì²œì•ˆê´€ìŒë³´ì‚´ë„ã€‹ (ê³ ë ¤ 14ì„¸ê¸°, êµ­ë¦½ì¤‘ì•™ë°•ë¬¼ê´€, ë³´ë¬¼, ì´ê±´í¬ íšŒì¥ ê¸°ì¦)

**ì‚¬ê²½ë¥˜**
â€¢ ã€Šê°ì§€ê¸ˆë‹ˆ ë¬˜ë²•ì—°í™”ê²½ã€‹ ê¶Œ1-7 (ê³ ë ¤ 1345ë…„, ë¦¬ì›€ë¯¸ìˆ ê´€)
â€¢ ã€Šë¶ˆì„¤ëŒ€ë³´ë¶€ëª¨ì€ì¤‘ê²½ã€‹ (ê³ ë ¤ 1378ë…„, êµ­ë¦½ì¤‘ì•™ë°•ë¬¼ê´€, ë³´ë¬¼, ì´ê±´í¬ íšŒì¥ ê¸°ì¦)

**ì¡°ì„ ë¶ˆí™”**
â€¢ ã€Šì„ê°€ì—¬ë˜ì‚¼ì¡´ë„ã€‹ (ì¡°ì„  1565ë…„, ë©”íŠ¸ë¡œí´ë¦¬íƒ„ë¯¸ìˆ ê´€)
â€¢ ã€Šì•½ì‚¬ì—¬ë˜ì‚¼ì¡´ë„ã€‹ (ì¡°ì„  1565ë…„, êµ­ë¦½ì¤‘ì•™ë°•ë¬¼ê´€, ë³´ë¬¼)
â€¢ ã€Šì„ê°€ì—¬ë˜ì„¤ë²•ë„ã€‹ (ì¡°ì„  1592ë…„, ë¦¬ì›€ë¯¸ìˆ ê´€)

**ì¼ë³¸ë¶ˆêµë¯¸ìˆ **
â€¢ ã€Šë³´í˜„ë³´ì‚´ì‹­ë‚˜ì°°ë…€ë„ã€‹ (ì¼ë³¸ ê°€ë§ˆì¿ ë¼ì‹œëŒ€ 14ì„¸ê¸°, ë‚˜ë¼êµ­ë¦½ë°•ë¬¼ê´€)
â€¢ ã€Šì•„ë¯¸íƒ€ì—¬ë˜ì´ì‹­ì˜¤ë³´ì‚´ë‚´ì˜ë„ã€‹ (ì¼ë³¸ ë¬´ë¡œë§ˆì¹˜/ëª¨ëª¨ì•¼ë§ˆì‹œëŒ€ 16ì„¸ê¸°, ë‚˜ë¼êµ­ë¦½ë°•ë¬¼ê´€)

**ë¶ˆêµ ììˆ˜ì™€ ë³µì‹**
â€¢ ã€Šììˆ˜ ê°€ì‚¬ã€‹ (ì¤‘êµ­ ëª… 15ì„¸ê¸°, í´ë¦¬ë¸”ëœë“œë¯¸ìˆ ê´€)
â€¢ ã€Šììˆ˜ ì•„ë¯¸íƒ€ì—¬ë˜ì‚¼ì¡´ë‚´ì˜ë„ã€‹ (ì¼ë³¸ ê°€ë§ˆì¿ ë¼/ë‚œë³´ì¿ ì´ˆì‹œëŒ€ 13-14ì„¸ê¸°)
â€¢ ã€Šì†¡ê´‘ì‚¬ ëª©ì¡°ê´€ìŒë³´ì‚´ì¢Œìƒ ë³µì¥ë¬¼ã€‹ (ì¡°ì„  1662ë…„, ì†¡ê´‘ì‚¬ì„±ë³´ë°•ë¬¼ê´€, ë³´ë¬¼)

[ì‘í’ˆ êµì²´ ì¼ì •]
ì „ì‹œ ê¸°ê°„ ì¤‘ ë³´ì¡´ì„ ìœ„í•´ ë‹¨ê³„ë³„ ì‘í’ˆ êµì²´ê°€ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤:
â€¢ ì „ê¸° 4ì£¼ (3.27-4.12): ã€Šììˆ˜ ì•„ë¯¸íƒ€ì—¬ë˜ì‚¼ì¡´ë‚´ì˜ë„ã€‹ ë“±
â€¢ ì „ê¸° 6ì£¼ (3.27-5.5): ã€Šì„ê°€íƒ„ìƒë„ã€‹, ã€Šêµ¬ìƒì‹œíšŒê¶Œã€‹ ë“± 12ì 
â€¢ í›„ê¸° 8ì£¼ (4.23-6.16): ã€Šììˆ˜ ì•„ë¯¸íƒ€ì—¬ë˜ë„ã€‹
â€¢ í›„ê¸° 6ì£¼ (5.7-6.16): ã€Šìˆ˜ì›”ê´€ìŒë³´ì‚´ë„ã€‹ ë“± 12ì 

[ê´€ëŒ ì§€ì›]
â€¢ íí”¼ì»¤ Appì„ í†µí•œ ì˜¤ë””ì˜¤ê°€ì´ë“œ
â€¢ ë„ìŠ¨íŠ¸ ì „ì‹œì„¤ëª…: í™”-ì¼, ì˜¤í›„ 2ì‹œ/4ì‹œ (ì¼ 2íšŒ)
â€¢ 1ì¸µ ì „ì‹œì‹¤ ì…êµ¬ì—ì„œ ì‹œì‘
â€¢ ì´ì–´í° ëŒ€ì—¬ ê°€ëŠ¥

[ì „ì‹œì˜ í˜„ëŒ€ì  ì˜ë¯¸]
ë¶ˆêµë¯¸ìˆ ì„ í†µí•´ ì—¬ì„±ì˜ ì—­í• ê³¼ ì§€ìœ„, ì‹ ì•™ê³¼ ì˜ˆìˆ ì  ê¸°ì—¬ë¥¼ ì¬ì¡°ëª…í•¨ìœ¼ë¡œì¨ ì„±í‰ë“±ê³¼ ì—¬ì„± ê¶Œìµì— ëŒ€í•œ í˜„ëŒ€ì  ì‹œê°ì„ ì œê³µí•©ë‹ˆë‹¤. ì „í†µë¬¸í™” ì†ì—ì„œ ì—¬ì„±ì´ ìˆ˜í–‰í–ˆë˜ ì ê·¹ì ì´ê³  ì°½ì¡°ì ì¸ ì—­í• ì„ ë°œêµ´í•˜ì—¬ ë™ì‹œëŒ€ì  ì˜ë¯¸ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.`,
      
      // ì‘ê°€ ì •ë³´ (ì‹œëŒ€ë³„ ì‘ê°€ë“¤)
      artists: [
        'ê³ ë ¤ì‹œëŒ€ ë¶ˆí™” í™”ì‚¬ë“¤', 'ì¡°ì„ ì‹œëŒ€ ë¶ˆí™” í™”ì‚¬ë“¤', 'ì¼ë³¸ ê°€ë§ˆì¿ ë¼ì‹œëŒ€ í™”ì‚¬ë“¤',
        'ê¸°ì¿ ì¹˜ ìš”ì‚¬ì´', 'ì¤‘êµ­ ëª…/ì²­ ììˆ˜ ì¥ì¸ë“¤'
      ],
      curator: 'í˜¸ì•”ë¯¸ìˆ ê´€',
      
      // ì‘í’ˆ ì •ë³´
      artworks_count: 92, // 92ê±´ì˜ ë™ì•„ì‹œì•„ ë¶ˆêµë¯¸ìˆ í’ˆ
      
      // ê´€ëŒ ì •ë³´
      admission_fee: 'ë³„ë„ ê³µì§€',
      operating_hours: JSON.stringify({
        ìš´ì˜ì‹œê°„: 'í™”-ì¼ 10:00-18:00',
        íœ´ê´€ì¼: 'ë§¤ì£¼ ì›”ìš”ì¼',
        ì˜ˆì•½: 'ì „ì‹œì˜ˆì•½ í•„ìš”',
        ë„ìŠ¨íŠ¸: 'í™”-ì¼ ì˜¤í›„ 2ì‹œ, 4ì‹œ (ì¼ 2íšŒ)',
        ì˜¤ë””ì˜¤ê°€ì´ë“œ: 'íí”¼ì»¤ App ì´ìš©'
      }),
      
      // ì—°ë½ì²˜
      contact_info: JSON.stringify({
        ëŒ€í‘œ: '031-320-1801~2',
        ë¬¸ì˜: '031-320-1801',
        í™ˆí˜ì´ì§€: 'hoam.samsung.org',
        ì˜ˆì•½: 'ì „ì‹œì˜ˆì•½ ì‹œìŠ¤í…œ ì´ìš©',
        ì˜¤ë””ì˜¤ê°€ì´ë“œ: 'íí”¼ì»¤ App ë‹¤ìš´ë¡œë“œ'
      }),
      phone_number: '031-320-1801',
      
      // URL ì •ë³´
      official_url: 'https://hoam.samsung.org',
      website_url: 'https://hoam.samsung.org',
      
      // ë°ì´í„° ë©”íƒ€ì •ë³´
      source: 'hoam_official',
      source_url: 'https://hoam.samsung.org',
      collected_at: new Date().toISOString(),
      
      // ê¸°ë³¸ê°’ ì„¤ì •
      view_count: 0,
      ai_verified: true,
      ai_confidence: 0.95
    };

    // ë°ì´í„° ì…ë ¥
    console.log('ğŸ“ ì „ì‹œ ë°ì´í„° ì…ë ¥ ì¤‘...');
    const { data, error } = await supabase
      .from('exhibitions')
      .insert([exhibitionData])
      .select();
    
    if (error) {
      throw error;
    }
    
    console.log('âœ… ã€Šì§„í™ì— ë¬¼ë“¤ì§€ ì•ŠëŠ” ì—°ê½ƒì²˜ëŸ¼ã€‹ ì „ì‹œ ë°ì´í„° ì…ë ¥ ì™„ë£Œ!');
    console.log('\nğŸ“‹ ì…ë ¥ëœ ì „ì‹œ ì •ë³´:');
    console.log(`  - ID: ${data[0].id}`);
    console.log(`  - ì œëª©: ${data[0].title_local}`);
    console.log(`  - ë¶€ì œ: ${data[0].subtitle}`);
    console.log(`  - ì¥ì†Œ: ${data[0].venue_name} (ì „ì‹œì‹¤ 1, 2)`);
    console.log(`  - ê¸°ê°„: ${data[0].start_date} ~ ${data[0].end_date}`);
    console.log(`  - ì‘í’ˆìˆ˜: ${data[0].artworks_count}ê±´ (êµ­ë‚´ì™¸ 27ê°œ ê¸°ê´€)`);
    console.log(`  - ìƒíƒœ: ${data[0].status} (ì¢…ë£Œ)`);
    console.log(`  - ì£¼ì œ: ì  ë” ê´€ì ì˜ ë™ì•„ì‹œì•„ ë¶ˆêµë¯¸ìˆ `);
    console.log(`  - íŠ¹ì§•: ê³ ë ¤ë¶ˆí™” ê±¸ì‘, ì‘í’ˆ êµì²´ ì „ì‹œ`);
    
    // í˜¸ì•”ë¯¸ìˆ ê´€ 2024ë…„ ì „ì‹œ í˜„í™©
    console.log('\nğŸ” í˜¸ì•”ë¯¸ìˆ ê´€ 2024ë…„ ì „ì‹œ í˜„í™©...');
    const { data: hoam2024, error: hoamError } = await supabase
      .from('exhibitions')
      .select('title_local, start_date, end_date, status')
      .eq('venue_name', 'í˜¸ì•”ë¯¸ìˆ ê´€')
      .gte('start_date', '2024-01-01')
      .lt('start_date', '2025-01-01')
      .order('start_date', { ascending: true });
    
    if (!hoamError && hoam2024) {
      console.log(`\nğŸ›ï¸ í˜¸ì•”ë¯¸ìˆ ê´€ 2024ë…„: ${hoam2024.length}ê°œ`);
      hoam2024.forEach((ex, index) => {
        const statusIcon = ex.status === 'closed' ? 'âœ…' : 
                          ex.status === 'ongoing' ? 'ğŸ”„' : 'ğŸ“…';
        console.log(`${index + 1}. ${ex.title_local} ${statusIcon}`);
        console.log(`   ${ex.start_date} ~ ${ex.end_date}`);
      });
    }
    
    // ë¶ˆêµë¯¸ìˆ  ì „ì‹œ ê²€ìƒ‰
    console.log('\nğŸ” ë¶ˆêµë¯¸ìˆ  ê´€ë ¨ ì „ì‹œ ê²€ìƒ‰...');
    const { data: buddhismExhibitions, error: buddhismError } = await supabase
      .from('exhibitions')
      .select('title_local, venue_name, start_date, end_date')
      .or('description.ilike.%ë¶ˆêµ%,description.ilike.%ë¶ˆí™”%,description.ilike.%ê´€ìŒ%,description.ilike.%ì•„ë¯¸íƒ€%,description.ilike.%ë³´ì‚´%,title_local.ilike.%ë¶ˆêµ%')
      .order('start_date', { ascending: false });
    
    if (!buddhismError && buddhismExhibitions) {
      console.log(`\nğŸ™ ë¶ˆêµë¯¸ìˆ  ê´€ë ¨ ì „ì‹œ: ${buddhismExhibitions.length}ê°œ`);
      buddhismExhibitions.slice(0, 5).forEach((ex, index) => {
        console.log(`${index + 1}. ${ex.title_local} (${ex.venue_name})`);
        console.log(`   ${ex.start_date} ~ ${ex.end_date}`);
      });
    }
    
    // ì  ë”/ì—¬ì„± ê´€ì  ì „ì‹œ ê²€ìƒ‰
    console.log('\nğŸ” ì  ë”/ì—¬ì„± ê´€ì  ì „ì‹œ ê²€ìƒ‰...');
    const { data: genderExhibitions, error: genderError } = await supabase
      .from('exhibitions')
      .select('title_local, venue_name, start_date, end_date')
      .or('description.ilike.%ì  ë”%,description.ilike.%ì—¬ì„±%,description.ilike.%ëª¨ì„±%,title_local.ilike.%ì—¬ì„±%')
      .order('start_date', { ascending: false });
    
    if (!genderError && genderExhibitions) {
      console.log(`\nğŸ‘© ì  ë”/ì—¬ì„± ê´€ì  ì „ì‹œ: ${genderExhibitions.length}ê°œ`);
      genderExhibitions.slice(0, 3).forEach((ex, index) => {
        console.log(`${index + 1}. ${ex.title_local} (${ex.venue_name})`);
        console.log(`   ${ex.start_date} ~ ${ex.end_date}`);
      });
    }
    
  } catch (error) {
    console.error('âŒ ë°ì´í„° ì…ë ¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error.message);
    if (error.details) console.error('ì„¸ë¶€ì‚¬í•­:', error.details);
  }
}

// ì‹¤í–‰
importHoamLotusBuddhism2024();